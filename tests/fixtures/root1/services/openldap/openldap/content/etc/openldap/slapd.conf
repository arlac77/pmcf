include /etc/openldap/schema/core.schema
include /etc/openldap/schema/cosine.schema
include /etc/openldap/schema/inetorgperson.schema
include /etc/openldap/schema/nis.schema

access to attrs=userPassword,givenName,sn,photo
        by self write
        by anonymous auth
        by dn.base="cn=Manager,{{base}}" write
        by * none

access to *
        by self read       
        by dn.base="cn=Manager,{{base}}" write
        by * read

access to dn.children="ou=accounts,{{base}}"
        by dn="cn=dovecot,ou=accounts,{{base}}" read
        by anonymous auth

access to dn.subtree="ou=accounts,{{base}}"
        by dn.base="cn=mail,ou=accounts,{{base}}" read

loglevel 0

pidfile		{{rundir}}slapd.pid
argsfile	{{rundir}}slapd.args

TLSCipherSuite HIGH:MEDIUM:-SSLv2:-SSLv3
TLSCertificateFile    /etc/ssl/certs/{{certname}}.cert.pem
TLSCertificateKeyFile /etc/ssl/private/{{certname}}.key.pem
TLSCACertificateFile  /etc/ssl/certs/mf-ca-chain.cert.pem
TLSCACertificatePath  /etc/ca-certificates/trust-source

database    config
rootdn      "cn=admin,cn=config"
rootpw      {{rootpw}}

database	mdb
maxsize		1073741824
suffix		"{{base}}"
rootdn		{{rootdn}}"
rootpw		{{rootpw}}
directory	{{datadir}}openldap-data

index	objectClass     eq
index   uid             pres,eq
index   mail            pres,sub,eq
index   cn              pres,sub,eq
index   sn              pres,sub,eq
index   dc              eq
